                                                         Generator Style Coroutine (4_await_suspend)                                               
                                                                                                                                                   
                    ┌────────┐          ┌───────┐          ┌─────────┐          ┌───────┐          ┌───────────┐          ┌─────────┐              
                    │consumer│          │awaiter│          │resumable│          │promise│          │coro_handle│          │coroutine│              
                    └───┬────┘          └───┬───┘          └────┬────┘          └───┬───┘          └─────┬─────┘          └────┬────┘              
                        │                   │                   │                   │                    │                     │                   
          ╔═════════╤═══╪═══════════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪══════════════╗    
          ║ INVOKE  │   │                   │                   │                   │                    │                     │              ║    
          ╟─────────┘   │                   │                   │        invoke     │                    │                     │              ║    
          ║             │ ────────────────────────────────────────────────────────────────────────────────────────────────────>│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                   │                 create                   │              ║    
          ║             │                   │                   │                   │<─────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                   │            get_return_object             │              ║    
          ║             │                   │                   │                   │<─────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                   │   from_promise     │                     │              ║    
          ║             │                   │                   │                   │───────────────────>│                     │              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                   │             initial_suspend              │              ║    
          ║             │                   │                   │                   │<─────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │               await_ready              │                     │              ║    
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                  false                 │                     │              ║    
          ║             │                   │ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ >│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │              await_suspend             │                     │              ║    
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │                   │       create       │                     │              ║    
          ║             │                   │                   │<─────────────────────────────────────────────────────────────│              ║    
          ║             │                   │                   │                   │                    │                     │              ║    
          ║             │                   │                   │        return     │                    │                     │              ║    
          ║             │ <────────────────────────────────────────────────────────────────────────────────────────────────────│              ║    
          ╚═════════════╪═══════════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪══════════════╝    
                        │                   │                   │                   │                    │                     │                   
                        │                   │                   │                   │                    │                     │                   
          ╔═════════════╪═══╤═══════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪═════════════════╗ 
          ║ RESUME & YIELD  │               │                   │                   │                    │                     │                 ║ 
          ╟─────────────────┘            resume                 │                   │                    │                     │                 ║ 
          ║             │ ─────────────────────────────────────>│                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                 done                   │                     │                 ║ 
          ║             │                   │                   │───────────────────────────────────────>│                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                 false                  │                     │                 ║ 
          ║             │                   │                   │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                resume                  │                     │                 ║ 
          ║             │                   │                   │───────────────────────────────────────>│                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │                    │       invoke        │                 ║ 
          ║             │                   │                   │                   │                    │────────────────────>│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │              await_resume              │                     │                 ║ 
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │                    │                     ────┐             ║ 
          ║             │                   │                   │                   │                    │                         │ work        ║ 
          ║             │                   │                   │                   │                    │                     <───┘             ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │                    │                     ────┐             ║ 
          ║             │                   │                   │                   │                    │                         │ co_yield    ║ 
          ║             │                   │                   │                   │                    │                     <───┘             ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │     yield_value    │                     │                 ║ 
          ║             │                   │                   │<─────────────────────────────────────────────────────────────│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │               await_ready              │                     │                 ║ 
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                  false                 │                     │                 ║ 
          ║             │                   │ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ >│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │              await_suspend             │                     │                 ║ 
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                 done                   │                     │                 ║ 
          ║             │                   │                   │───────────────────────────────────────>│                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                 false                  │                     │                 ║ 
          ║             │                   │                   │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │        return     │                    │                     │                 ║ 
          ║             │ <────────────────────────────────────────────────────────────────────────────────────────────────────│                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                 value                 │                   │                    │                     │                 ║ 
          ║             │ ─────────────────────────────────────>│                   │                    │                     │                 ║ 
          ║             │                   │                   │                   │                    │                     │                 ║ 
          ║             │                   │                   │                promise                 │                     │                 ║ 
          ║             │                   │                   │───────────────────────────────────────>│                     │                 ║ 
          ╚═════════════╪═══════════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪═════════════════╝ 
                        │                   │                   │                   │                    │                     │                   
                        │                   │                   │                   │                    │                     │                   
          ╔═════════════╪════╤══════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪══════════════════╗
          ║ RESUME & RETURN  │              │                   │                   │                    │                     │                  ║
          ╟──────────────────┘           resume                 │                   │                    │                     │                  ║
          ║             │ ─────────────────────────────────────>│                   │                    │                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                 done                   │                     │                  ║
          ║             │                   │                   │───────────────────────────────────────>│                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                 false                  │                     │                  ║
          ║             │                   │                   │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                resume                  │                     │                  ║
          ║             │                   │                   │───────────────────────────────────────>│                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                   │                    │       invoke        │                  ║
          ║             │                   │                   │                   │                    │────────────────────>│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │              await_resume              │                     │                  ║
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                   │                    │                     ────┐              ║
          ║             │                   │                   │                   │                    │                         │ work         ║
          ║             │                   │                   │                   │                    │                     <───┘              ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                   │                    │                     ────┐              ║
          ║             │                   │                   │                   │                    │                         │ co_return    ║
          ║             │                   │                   │                   │                    │                     <───┘              ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                   │    return_value    │                     │                  ║
          ║             │                   │                   │<─────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                   │    final_suspend   │                     │                  ║
          ║             │                   │                   │<─────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │               await_ready              │                     │                  ║
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                  false                 │                     │                  ║
          ║             │                   │ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ >│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │              await_suspend             │                     │                  ║
          ║             │                   │<─────────────────────────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                 done                   │                     │                  ║
          ║             │                   │                   │───────────────────────────────────────>│                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                 true                   │                     │                  ║
          ║             │                   │                   │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │        return     │                    │                     │                  ║
          ║             │ <────────────────────────────────────────────────────────────────────────────────────────────────────│                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                 value                 │                   │                    │                     │                  ║
          ║             │ ─────────────────────────────────────>│                   │                    │                     │                  ║
          ║             │                   │                   │                   │                    │                     │                  ║
          ║             │                   │                   │                promise                 │                     │                  ║
          ║             │                   │                   │───────────────────────────────────────>│                     │                  ║
          ╚═════════════╪═══════════════════╪═══════════════════╪═══════════════════╪════════════════════╪═════════════════════╪══════════════════╝
                    ┌───┴────┐          ┌───┴───┐          ┌────┴────┐          ┌───┴───┐          ┌─────┴─────┐          ┌────┴────┐              
                    │consumer│          │awaiter│          │resumable│          │promise│          │coro_handle│          │coroutine│              
                    └────────┘          └───────┘          └─────────┘          └───────┘          └───────────┘          └─────────┘              